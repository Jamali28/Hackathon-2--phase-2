<!--
Sync Impact Report:
- Version change: [None] → 1.0.0
- List of modified principles:
  - PRINCIPLE_1: Spec-Driven Development
  - PRINCIPLE_2: No Manual Coding
  - PRINCIPLE_3: Mandatory Tech Stack
  - PRINCIPLE_4: Strict Monorepo Structure
  - PRINCIPLE_5: Agentic Workflow
  - PRINCIPLE_6: Authentication & Security Rules
- Added sections: API Design, Final Deliverable
- Templates requiring updates:
  - ⚠ pending: .specify/templates/plan-template.md
  - ⚠ pending: .specify/templates/spec-template.md
  - ⚠ pending: .specify/templates/tasks-template.md
- Follow-up TODOs: Ensure sub-agents use these rules during delegation.
-->

# Todo Full-Stack Web Application Constitution

## Core Principles

### I. Spec-Driven Development
Always read relevant `@specs/*.md` before implementing. If requirements change, the specification must be updated first. Reference specs precisely using code references or file paths.

### II. No Manual Coding
All source code MUST be generated by agents (Claude Code + specialized sub-agents). Human interaction is restricted to writing/updating specifications in `/specs/` and providing clarification. The process, prompts, and agent delegation are the primary evaluation criteria.

### III. Mandatory Tech Stack
Implementation must strictly adhere to:
- **Frontend**: Next.js 16+ (App Router), TypeScript, Tailwind CSS
- **Backend**: Python FastAPI
- **ORM**: SQLModel
- **Database**: Neon Serverless PostgreSQL
- **Authentication**: Better Auth (Next.js) with JWT plugin
- **Development**: Spec-Kit Plus + Claude Code in monorepo

### IV. Strict Monorepo Structure
The project must follow the defined hierarchy:
- `/specs/`: Feature, Architecture, API, and DB specs
- `/agents/`: 7 specialized agent definitions (.md)
- `/skills/`: 6 reusable skill patterns (.md)
- `/frontend/` & `/backend/`
- `docker-compose.yml`

### V. Agentic Workflow
Execution must follow the strict order:
1. `@agents/spec-writer.md` writes/updates specs.
2. `@agents/orchestrator.md` creates plans, tasks, and delegates.
3. Specialists implement using `@skills/*.md` patterns.
4. `@agents/tester.md` performs final validation.

### VI. Authentication & Security Rules
- **JWT**: Better Auth issues tokens; shared `BETTER_AUTH_SECRET` is used for verification.
- **Verification**: Backend verifies JWT with PyJWT and extracts `user_id`.
- **Isolation**: ALL database queries MUST be filtered by `user_id`. No cross-user data exposure.
- **Fail-Safe**: Invalid or missing tokens must result in `401 Unauthorized`.

## API Design

The API must use clean paths (e.g., `/api/tasks`) rather than including `user_id` in the URL. User context is derived solely from the verified JWT. Endpoints must support query parameters for status filtering (`all|pending|completed`) and sorting (`created|title`).

## Development Workflow

All agents MUST load and apply `@skills/*.md` patterns when relevant to ensure consistency across the codebase. Every implementation step must be recorded in Prompt History Records (PHRs) for total traceability.

## Governance

This constitution supersedes all other development practices within the project. Any amendments must be documented, versioned, and reflected across all dependent templates. Governance ensures compliance with the core objective: transforming Phase 1 into a secure, multi-user full-stack app via agentic process.

**Version**: 1.0.0 | **Ratified**: 2026-01-06 | **Last Amended**: 2026-01-06
